close all
T = linspace(275,1500);
figure
hold on
for P=10:1:21
    rho = 0.004*P*10e5./(8.314.*(T+273.15));
    plot(T,rho,'linewidth',1.5)
    hold on
end
title('Variación de densidad de Helio con temperatura y presión')
leg=cell(10,1);
for i=0:1:10
    leg{i+1}=["P"+num2str(10+i)];
end
legend(leg)
hold off


a={
    "20	-253	-424	10	145	6.00	24.02	1.500	0.04661	235.6	1.500",
"40	-233	-388	10	145	2.93	11.72	0.7317	0.02274	114.9	0.7317",
"60	-213	-352	10	145	1.96	7.850	0.4901	0.01523	76.98	0.4901",
"80	-193	-316	10	145	1.477	5.912	0.3691	0.01147	57.98	0.3691",
"100	-173	-280	10	145	1.185	4.745	0.2962	0.00921	46.53	0.2962",
"120	-153	-244	10	145	0.9901	3.963	0.2474	0.00769	38.86	0.2474",
"140	-133	-208	10	145	0.8502	3.403	0.2124	0.00660	33.37	0.2124",
"160	-113	-172	10	145	0.7450	2.982	0.1862	0.00579	29.24	0.1862",
"180	-93.2	-136	10	145	0.6628	2.653	0.1656	0.00515	26.02	0.1656",
"200	-73.2	-100	10	145	0.5971	2.390	0.1492	0.00464	23.44	0.1492",
"220	-53.2	-63.7	10	145	0.5431	2.174	0.1357	0.00422	21.32	0.1357",
"240	-33.2	-27.7	10	145	0.4982	1.994	0.1245	0.00387	19.55	0.1245",
"260	-13.2	8.3	10	145	0.4602	1.842	0.1150	0.00357	18.06	0.1150",
"280	6.9	44.3	10	145	0.4275	1.711	0.1068	0.00332	16.78	0.1068",
"300	26.9	80.3	10	145	0.3990	1.597	0.09970	0.00310	15.66	0.09970",
"320	46.9	116	10	145	0.3743	1.498	0.09352	0.00291	14.69	0.09352",
"340	66.9	152	10	145	0.3523	1.410	0.08802	0.00274	13.83	0.08802",
"360	86.9	188	10	145	0.3328	1.332	0.08315	0.00258	13.06	0.08315",
"400	127	260	10	145	0.2998	1.200	0.07491	0.00233	11.77	0.07491",
"500	227	440	10	145	0.2399	0.9604	0.05996	0.00186	9.42	0.05996",
"600	327	620	10	145	0.2000	0.8007	0.04999	0.00155	7.85	0.04999",
"700	427	800	10	145	0.1715	0.6866	0.04286	0.00133	6.73	0.04286",
"800	527	980	10	145	0.1501	0.6009	0.03751	0.00117	5.89	0.03751",
"900	627	1160	10	145	0.1335	0.5342	0.03335	0.00104	5.24	0.03335",
"1000	727	1340	10	145	0.1201	0.4809	0.03002	0.00093	4.72	0.03002"};
T2=zeros(length(a),1);
rho2=zeros(length(a),1);
for i=1:length(a)
    s=split(a{i},"	");
    T2(i)=s(2);
    rho2(i)=s(7);
end




Temperature10=[
50.0,
55.0,
60.0,
65.0,
70.0,
75.0,
80.0,
90.0,
100.0,
125.0,
150.0,
175.0,
200.0,
225.0,
250.0,
275.0,
300.0,
350.0,
400.0,
450.0,
500.0,
600.0,
700.0,
800.0,
900.0,
1000.0,
1100.0,
1200.0,
1300.0,
1400.0,
1500.0]


Density10=[
9.417,
8.568,
7.861,
7.263,
6.750,
6.305,
5.916,
5.266,
4.746 ,
3.806,
3.178,
2.728,
2.389,
2.126,
1.914,
1.741,
1.597,
1.370,
1.199,
1.067,
0.9603,
0.8006,
0.6865,
0.6009,
0.5342,
0.4809,
0.4372,
0.4008,
0.3700,
0.3436,
0.3207];


Temperature20=[
50.0,
55.0,
60.0,
65.0,
70.0,
75.0,
80.0,
90.0,
100.0,
125.0,
150.0,
175.0,
200.0,
225.0,
250.0,
275.0,
300.0,
350.0,
400.0,
450.0,
500.0,
600.0,
700.0,
800.0,
900.0,
1000.0,
1100.0,
1200.0,
1300.0,
1400.0,
1500.0];
Density20=[
18.43,
16.78,
15.41,
14.25,
13.25,
12.39,
11.64,
10.37,
9.360,
7.526,
6.294,
5.410,
4.744,
4.224,
3.807,
3.465,
3.179,
2.729,
2.391,
2.127,
1.915,
1.598,
1.371,
1.200,
1.067,
0.9607,
0.8736,
0.8009,
0.7395,
0.6867,
0.6410];
for P=10:10:20
    rho = 0.004*P*1e5./(8.314.*(T));
    if P==10
        plot(Temperature10(16:end),Density10(16:end),'bo','markersize',8,'linewidth',1.2)
        hold on
        plot(T,rho,'b','linewidth',1.5)
    else
        plot(Temperature20(16:end),Density20(16:end),'rs','markersize',8,'linewidth',1.2)
        hold on
        plot(T,rho,'r','linewidth',1.5)
    end
    t="Densidad del Helio-4 en función de la temperatura a 10/20 bar";
    title(t)
    xlabel('Temperatura (K)')
    ylabel('Densidad (kg/m3)')
    
    
end
legend('Datos empíricos 10 bar','Gas perfecto 10 bar','Datos empíricos 20 bar','Gas perfecto 20 bar')

T10=Temperature10(16:end);
d10=Density10(16:end);
d20=Density20(16:end);

rho10 = 0.004*10*1e5./(8.314.*(T10));
N=length(T10);
rho20 = 0.004*20*1e5./(8.314.*(T10));
error=[];
contador=0;
for i=1:length(N)
    error=[error,abs(rho10(i)-d10(i))/d10(i)];
    contador=contador+1;
end
error2=max(error)
    